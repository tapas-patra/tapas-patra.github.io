// Mistral API Helper Functions
async function callMistralAPI(endpoint, payload) {
    try {
        const response = await fetch(`https://api.mistral.ai/v1/${endpoint}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${CONFIG.MISTRAL_API_KEY}`
            },
            body: JSON.stringify(payload)
        });
        
        if (!response.ok) {
            const errorData = await response.json();
            throw new Error(`Mistral API Error: ${errorData.error?.message || response.statusText}`);
        }
        
        return await response.json();
    } catch (error) {
        console.error(`Error calling Mistral API (${endpoint}):`, error);
        throw error;
    }
}

// Generate embeddings using Mistral
async function generateEmbedding(text) {
    const response = await callMistralAPI('embeddings', {
        model: CONFIG.MISTRAL_EMBEDDING_MODEL,
        input: text
    });
    
    return response.data[0].embedding;
}

// Generate chat completion using Mistral
async function generateChatCompletion(messages) {
    const response = await callMistralAPI('chat/completions', {
        model: CONFIG.MISTRAL_COMPLETION_MODEL,
        messages: messages
    });
    
    return response.choices[0].message.content;
}
